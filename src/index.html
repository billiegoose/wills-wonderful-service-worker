<!DOCTYPE html>
<title>WWSW.js</title>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/picnic@6.4.0/picnic.min.css">
<h1>WWSW.js Test Page</h1>
<button id="registerWWSW">Register WWSW</button>
<button id="connectWithComlink">Connect with Comlink</button>
<button id="doThings">Do Things</button>

<script type="module">
  import Client from './client.js'
  const client = await Client()
  
  function log (str) {
    var div = document.createElement('h4')
    div.innerHTML = str
    document.body.appendChild(div)
  }

  export async function registerWWSW () {
    if (!navigator.serviceWorker) {
      console.log(`Oh no! Your browser doesn't support a feature needed to run this app (navigator.serviceWorker). Try using a different browser.`)
      return
    }
    let reg = await navigator.serviceWorker.register('./worker.umd.js', {scope: '/'})
    // reg.addEventListener('updatefound', () => {
    //   let newWorker = reg.installing
    //   newWorker.addEventListener('statechange', () => {
    //     if (newWorker.state === 'activated') {
    //     }
    //   })
    // })
  }


  export async function doThings () {
    console.log(await fs.readFile('.uuid', 'utf8'))
    console.log(await fs.readdir('.'))
    console.log(await git.init({dir: '.'}))
    fsEvents.emit('foobar', {type: 'barbarbar'})
  }

  document.getElementById('registerWWSW').addEventListener('click', registerWWSW)
  document.getElementById('connectWithComlink').addEventListener('click', connectWithComlink)
  document.getElementById('doThings').addEventListener('click', doThings)
</script>